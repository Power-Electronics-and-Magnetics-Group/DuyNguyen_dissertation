Version 4
SHEET 1 4440 3892
WIRE -1056 640 -1056 576
WIRE -944 640 -1056 640
WIRE -912 640 -944 640
WIRE -816 640 -832 640
WIRE -688 640 -816 640
WIRE -480 640 -480 560
WIRE -480 640 -608 640
WIRE -400 640 -480 640
WIRE -256 640 -336 640
WIRE -112 640 -112 560
WIRE -112 640 -256 640
WIRE -480 656 -480 640
WIRE -1056 672 -1056 640
WIRE -256 688 -256 640
WIRE -480 768 -480 736
WIRE -112 768 -112 640
WIRE -640 784 -640 768
WIRE -528 784 -640 784
WIRE -1056 800 -1056 752
WIRE -944 800 -944 640
WIRE -640 832 -640 784
WIRE -528 848 -528 832
WIRE -944 896 -944 864
WIRE -1056 928 -1056 880
WIRE -480 928 -480 848
WIRE -256 928 -256 752
WIRE -112 928 -112 848
WIRE -640 992 -640 912
WIRE -816 1040 -816 640
WIRE -1136 1184 -1136 1136
WIRE -976 1184 -1136 1184
WIRE -816 1200 -816 1104
WIRE -1136 1248 -1136 1184
WIRE -976 1248 -976 1184
WIRE -1760 1264 -1760 1200
WIRE -1488 1264 -1488 1184
WIRE -1488 1264 -1760 1264
WIRE -1184 1264 -1488 1264
WIRE -1760 1328 -1760 1264
WIRE -1184 1328 -1184 1312
WIRE 480 1328 480 1264
WIRE -1136 1408 -1136 1328
WIRE -976 1408 -976 1312
WIRE -976 1408 -1136 1408
WIRE -960 1408 -976 1408
WIRE -816 1408 -816 1200
WIRE -816 1408 -880 1408
WIRE 480 1456 480 1408
WIRE 480 1456 368 1456
WIRE -1136 1488 -1136 1408
WIRE -1184 1504 -1184 1488
WIRE -976 1504 -976 1408
WIRE 368 1504 368 1456
WIRE 0 1520 -48 1520
WIRE 128 1520 80 1520
WIRE 256 1520 192 1520
WIRE 480 1520 480 1456
WIRE -1488 1552 -1488 1264
WIRE -1184 1552 -1488 1552
WIRE -704 1552 -704 1472
WIRE -464 1552 -464 1456
WIRE -304 1552 -304 1488
WIRE -1136 1584 -1136 1568
WIRE -976 1584 -976 1568
WIRE -976 1584 -1136 1584
WIRE -1760 1616 -1760 1408
WIRE -1136 1616 -1136 1584
WIRE 64 1632 64 1600
WIRE 256 1632 256 1520
WIRE 368 1632 368 1584
WIRE 368 1632 256 1632
WIRE 480 1632 480 1584
WIRE 480 1632 368 1632
WIRE -304 1648 -304 1632
WIRE 256 1648 256 1632
WIRE 256 1648 96 1648
WIRE -48 1664 -48 1520
WIRE -48 1664 -144 1664
WIRE 32 1664 -48 1664
WIRE 368 1664 368 1632
WIRE -704 1680 -704 1632
WIRE 256 1680 96 1680
WIRE 64 1728 64 1696
WIRE 256 1728 256 1680
WIRE 368 1776 368 1744
WIRE 256 1824 256 1808
WIRE -96 1872 -96 1856
WIRE 32 1872 32 1856
FLAG -1056 928 0
FLAG -528 848 0
FLAG -480 928 0
FLAG -256 928 0
FLAG -112 928 0
FLAG -1056 576 Vin
FLAG -480 560 Vds
FLAG -640 768 Vgs1
FLAG -112 560 Vo
FLAG -944 896 0
FLAG -1136 1616 0
FLAG -1184 1328 0
FLAG -1184 1488 0
FLAG -1488 1184 nG1
FLAG -1760 1200 nXX
FLAG -1136 1136 Vdd
FLAG -704 1680 0
FLAG -704 1472 Vdd
FLAG -816 1200 Vx
FLAG 256 1824 0
FLAG 368 1776 0
FLAG 480 1264 Vo
FLAG -144 1664 nPIOut
FLAG -304 1648 0
FLAG -304 1488 nsaw
FLAG -464 1632 0
FLAG -464 1456 ngate
FLAG -96 1872 0
FLAG 32 1872 0
FLAG -96 1776 Vp
FLAG 32 1776 Vn
FLAG 64 1600 Vp
FLAG 64 1728 Vn
FLAG -640 992 ngate
FLAG -1760 1616 ngate
SYMBOL voltage -1056 784 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vin1
SYMATTR Value {Vin}
SYMBOL ind2 -704 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L
SYMATTR Value {L}
SYMATTR Type ind
SYMBOL res -1040 768 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rin1
SYMATTR Value {Rin}
SYMBOL sw -480 864 M180
WINDOW 0 40 35 Left 2
WINDOW 3 42 60 Left 2
SYMATTR InstName S1
SYMATTR Value SWA
SYMBOL diode -400 656 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL cap -272 688 R0
SYMATTR InstName C
SYMATTR Value {C}
SYMATTR SpiceLine Rser=0.05
SYMBOL res -128 752 R0
SYMATTR InstName Ro
SYMATTR Value {Ro}
SYMBOL res -656 816 R0
SYMATTR InstName Rg
SYMATTR Value 10
SYMBOL res -496 640 R0
SYMATTR InstName R5
SYMATTR Value 1m
SYMBOL ind -864 1392 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Lbuck1
SYMATTR Value 6.3µ
SYMBOL sw -1136 1344 M180
WINDOW 0 40 35 Left 2
WINDOW 3 42 60 Left 2
SYMATTR InstName S2
SYMATTR Value SW_H
SYMBOL sw -1136 1584 M180
WINDOW 0 40 35 Left 2
WINDOW 3 42 60 Left 2
SYMATTR InstName S3
SYMATTR Value SW_H
SYMBOL cap -832 1040 R0
SYMATTR InstName C2
SYMATTR Value 4.7µ
SYMBOL voltage -704 1536 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vdd
SYMATTR Value 9.74
SYMBOL res -1776 1312 R0
SYMATTR InstName Rg1
SYMATTR Value 10
SYMBOL diode -960 1312 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode -960 1568 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL cap -960 800 R0
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL res -928 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rin2
SYMATTR Value 20m
SYMBOL res -16 1504 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R3}
SYMBOL cap 192 1504 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {C3}
SYMBOL voltage 256 1712 R0
SYMATTR InstName Vref1
SYMATTR Value {Vref}
SYMBOL res 352 1648 R0
SYMATTR InstName R2
SYMATTR Value {R4}
SYMBOL res 352 1488 R0
SYMATTR InstName R3
SYMATTR Value {R2}
SYMBOL cap 464 1520 R0
SYMATTR InstName C4
SYMATTR Value {C2}
SYMBOL res 464 1312 R0
SYMATTR InstName R4
SYMATTR Value {R1}
SYMBOL voltage -304 1536 R0
WINDOW 3 -712 59 Invisible 2
SYMATTR Value PWL repeat forever (0 0 {1/(fconv*2)} 5 {1/fconv} 0) endrepeat
SYMATTR InstName V3
SYMBOL bv -464 1536 R0
WINDOW 3 -129 193 Left 2
SYMATTR Value V=if (V(nPIOut)>=V(nsaw),5,-5)
SYMATTR InstName B1
SYMBOL OPA659 64 1600 M0
SYMATTR InstName U1
SYMBOL voltage -96 1760 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vp1
SYMATTR Value 6
SYMBOL voltage 32 1760 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vn1
SYMATTR Value -6
TEXT -624 1136 Left 2 !.param fconv=150k \n.param Tconv=1/fconv\n.param trise=Tconv/2\n.param tfall=trise\n.param D=0.5\n.param ton=D*Tconv
TEXT -1080 120 Left 2 !.options Noopiter\n.options Gmin=1e-8 abstol=5e-7 vntol=5e-7 trtol=100 sstol=3e-3
TEXT -1072 80 Left 2 !.tran 0 220m 219m 10n
TEXT -1080 184 Left 2 !.options plotwinsize=0\n.options numdgt=10
TEXT -1080 280 Left 2 !.model SWA SW (Ron=1m Roff=10Meg Vt=2 Vh=1)\n.model MyIdealDiode D(Ron=.1 Roff=1Meg Vfwd=.4)
TEXT -1272 832 Left 2 !.param Rin=0.01\n.param Vin=200
TEXT -352 512 Left 2 !.param L=250u\n.param C=330u\n.param Ro=533
TEXT -952 520 Left 2 !.param Lf=34.1u\n.param Cf=330u\n.param RCf=1m
TEXT -280 976 Left 2 !.param Rc=1n
TEXT -1712 1056 Left 2 !.model SW_H SW (Ron=.01 Roff=10Meg Vt=3 Vh=1)
TEXT -1568 1664 Left 2 !.param D1=0.5\n.param ton1=D1*Tconv
TEXT -72 744 Left 2 !.ic V(Vo)=400
TEXT 64 1256 Left 2 !.param Vref=2.5\n.param R1=3.3k\n.param R2=200k\n.param R3=120k\n.param R4=1.28k\n.param C2=2.5n\n.param C3=3.85n
TEXT 64 1160 Left 2 !.lib "OPA659.LIB"
